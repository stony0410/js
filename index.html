<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Soha çš„å¹»æƒ³é¦–é </title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
font-family: Arial, sans-serif;
background: #333;
color: white;
height: 100vh;
overflow: hidden;
}

.container {
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
height: 100vh;
text-align: center;
}

h1 {
font-size: 3em;
margin-bottom: 20px;
}

#typewriter {
font-size: 1.5em;
margin: 20px 0;
max-width: 600px;
}

.btn {
margin: 10px;
padding: 10px 25px;
font-size: 1em;
background: #555;
color: white;
border: none;
border-radius: 8px;
cursor: pointer;
transition: all 0.3s ease;
}

.btn:hover {
background: #777;
transform: translateY(-2px);
}

#quote {
margin-top: 30px;
font-size: 1.2em;
max-width: 600px;
}

#gameContainer {
display: none;
justify-content: center;
align-items: center;
height: 100vh;
position: relative;
}

#gameCanvas {
border: 3px solid white;
border-radius: 8px;
background: black;
}

.back-btn {
position: absolute;
top: 10px;
left: 10px;
}

.game-ui {
position: absolute;
top: 10px;
right: 10px;
font-size: 1.2em;
color: white;
}

.game-over {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
background: rgba(0,0,0,0.9);
padding: 30px;
border-radius: 15px;
text-align: center;
display: none;
max-width: 400px;
width: 90%;
animation: fadeInScale 0.5s ease-out;
}

@keyframes fadeInScale {
from {
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.8);
}
to {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}
}

.game-over-image {
width: 150px;
height: auto;
margin-bottom: 20px;
border-radius: 10px;
animation: bounce 2s infinite;
}

@keyframes bounce {
0%, 20%, 50%, 80%, 100% {
  transform: translateY(0);
}
40% {
  transform: translateY(-10px);
}
60% {
  transform: translateY(-5px);
}
}

.game-over p {
font-size: 1.2em;
margin-bottom: 20px;
color: #ffd93d;
}

.game-over .btn {
background: #4ecdc4;
margin: 5px;
font-size: 1.1em;
}

.game-over .btn:hover {
background: #45b7b8;
}
</style>
</head>
<body>
<div class="container" id="main">
<h1>ä½ å¥½ï¼Œæˆ‘æ˜¯ Soha ğŸŒ¤ï¸</h1>
<div id="typewriter"></div>
<button class="btn" onclick="getQuote()">çµ¦æˆ‘ä¸€å¥è©©å¥ ğŸ’¬</button>
<button class="btn" onclick="startGame()">å°éŠæˆ²å…¥å£ ğŸ®</button>
<div id="quote"></div>
</div>

<div id="gameContainer">
<button class="btn back-btn" onclick="endGame()">â† å›ä¸»é </button>
<div class="game-ui">
<div>åˆ†æ•¸: <span id="score">0</span></div>
</div>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<div class="game-over" id="gameOver">
<img src="https://d41chssnpqdne.cloudfront.net/user_upload_by_module/chat_bot/files/80700721/STwwHuGcuiWMOW5i.png?Expires=1750778057&Signature=oWcyF7o0r5w4fEjnEqIyMqKt8Ukr8FYXRlTZiyqajqIVZqOJznHI7nkpNKo3LINBxsYuy2w373uyBYdCaT8l3A76748eENKfhKj3Z6tEopbQZ57Zhf0nNwA1hWrHnKea6ynX1Fe5zjbXEUv9n~O3qhGaUBMMAcFjh0TvAYYr61T-Zf7U1r0-75q4ClCLT-x7P4jv0kmKcW0GCHWKzjdP8po3iMVF32QG-dXILgVU~YVQ220Wxk-e2k1mzsbjFT03JnIGlrHwGfjD2wV2cUz5qqnlS3Ecg0ONwo-7fA0DTRppVC~WeRC90EEHQpquNlO1a~ivA8Nz3kx3xTD-lBz2rg__&Key-Pair-Id=K3USGZIKWMDCSX" 
     alt="éŠæˆ²çµæŸ" class="game-over-image">
<p>æœ€çµ‚åˆ†æ•¸: <span id="finalScore">0</span></p>
<button class="btn" onclick="restartGame()">é‡æ–°é–‹å§‹ ğŸ”„</button>
<button class="btn" onclick="endGame()">å›ä¸»é  ğŸ </button>
</div>
</div>

<script>
/* ğŸ“– ç¬¬03ç«  è®Šæ•¸ã€å¸¸æ•¸ã€å‹åˆ¥èˆ‡é‹ç®—å­ */
const text = "å¤¢æƒ³å°±åƒå¤©ç©ºï¼Œæ™‚è€Œæ˜äº®ï¼Œæ™‚è€Œé™°å½±ï¼Œ\nä½†æˆ‘å€‘ç¸½åœ¨é›²å±¤å¾Œæ‰¾åˆ°å…‰ã€‚";
let i = 0;

/* ğŸ“– ç¬¬05ç«  å‡½å¼ */
function typeWriter() {
/* ğŸ“– ç¬¬04ç«  æµç¨‹æ§åˆ¶ - if æ¢ä»¶åˆ¤æ–· */
if (i < text.length) {
  /* ğŸ“– ç¬¬08ç«  DOM - getElementById() å–å¾—å…ƒç´  */
  document.getElementById("typewriter").innerHTML += text.charAt(i);
  /* ğŸ“– ç¬¬03ç«  è®Šæ•¸ã€å¸¸æ•¸ã€å‹åˆ¥èˆ‡é‹ç®—å­ - éå¢é‹ç®—å­ */
  i++;
  /* ğŸ“– ç¬¬10ç«  BOM - setTimeout() è¨ˆæ™‚å™¨ */
  setTimeout(typeWriter, 50);
}
}
typeWriter();

/* ğŸ“– ç¬¬12ç«  Ajax èˆ‡ JSON */
function getQuote() {
/* ğŸ“– ç¬¬12ç«  Ajax - fetch() API */
fetch("https://type.fit/api/quotes")
  .then(res => res.json())
  .then(data => {
    /* ğŸ“– ç¬¬06ç«  å…§å»ºç‰©ä»¶ - Math.random() */
    const quote = data[Math.floor(Math.random() * data.length)];
    /* ğŸ“– ç¬¬08ç«  DOM - è¨­å®šå…ƒç´ å…§å®¹ */
    document.getElementById("quote").innerHTML = 
      `âœ¨ "${quote.text}"<br>â€“ ${quote.author || "ç„¡åè©©äºº"}`;
  })
  .catch(() => {
    document.getElementById("quote").innerHTML = 
      `âœ¨ "æ¯å€‹å›°é›£éƒ½æ˜¯æˆé•·çš„æ©Ÿæœƒã€‚"<br>â€“ Soha`;
  });
}

function startGame() {
/* ğŸ“– ç¬¬08ç«  DOM - æ“ä½œCSSæ¨£å¼ */
document.getElementById("main").style.display = "none";
document.getElementById("gameContainer").style.display = "flex";
initGame();
gameLoop();
}

function endGame() {
/* ğŸ“– ç¬¬10ç«  BOM - location.reload() */
location.reload();
}

function restartGame() {
document.getElementById("gameOver").style.display = "none";
initGame();
gameLoop();
}

/* ğŸ“– ç¬¬08ç«  DOM - getElementById() å–å¾—canvaså…ƒç´  */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

/* ğŸ“– ç¬¬03ç«  è®Šæ•¸ã€å¸¸æ•¸ã€å‹åˆ¥èˆ‡é‹ç®—å­ - éŠæˆ²è®Šæ•¸ */
let player, bullets, enemies, enemyBullets;
let keys = {}, frame = 0, mouseDown = false, shootInterval = 0;
let score = 0, level = 1, damage = 1, gameRunning = true;

/* ğŸ“– ç¬¬05ç«  å‡½å¼ - éŠæˆ²åˆå§‹åŒ– */
function initGame() {
/* ğŸ“– ç¬¬06ç«  å…§å»ºç‰©ä»¶ - Object ç‰©ä»¶ */
player = { 
  x: 180, 
  y: 520, 
  width: 40, 
  height: 40, 
  speed: 5,
  maxSpeed: 12
};
/* ğŸ“– ç¬¬06ç«  å…§å»ºç‰©ä»¶ - Array ç‰©ä»¶ */
bullets = [];
enemies = [];
enemyBullets = [];

frame = 0;
score = 0;
level = 1;
damage = 1;
gameRunning = true;
mouseDown = false;
shootInterval = 0;

updateUI();
}

/* ğŸ“– ç¬¬08ç«  DOM - æ›´æ–°UIé¡¯ç¤º */
function updateUI() {
document.getElementById("score").textContent = score;
}

/* ğŸ¯ ç­‰ç´šæª¢æŸ¥èˆ‡æå‡ (ç„¡æç¤º) */
function checkLevelUp() {
const newLevel = Math.floor(score / 100) + 1;
if (newLevel > level) {
  level = newLevel;
  damage = level;
  player.speed = Math.min(5 + (level - 1), player.maxSpeed);
  // ç§»é™¤ç­‰ç´šæå‡æç¤º
}
}

/* ğŸ“Š æ ¹æ“šç­‰ç´šè¨ˆç®—é›£åº¦åƒæ•¸ */
function getDifficultySettings() {
return {
  spawnRate: Math.max(50 - (level - 1) * 3, 20),
  enemySpeed: 2 + Math.floor((level - 1) * 0.5),
  enemyShootRate: Math.max(70 - (level - 1) * 5, 25),
  maxEnemies: 3 + Math.floor((level - 1) / 2),
  bulletSpeed: 4 + Math.floor((level - 1) * 0.3),
  enemyHealth: 1 + Math.floor((level - 1) / 3)
};
}

/* ğŸ“– ç¬¬09ç«  äº‹ä»¶è™•ç† - éµç›¤äº‹ä»¶ */
document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);
/* ğŸ“– ç¬¬09ç«  äº‹ä»¶è™•ç† - æ»‘é¼ äº‹ä»¶ */
canvas.addEventListener('mousedown', e => { if (e.button === 0) mouseDown = true; });
canvas.addEventListener('mouseup', e => { if (e.button === 0) mouseDown = false; });
canvas.addEventListener('contextmenu', e => e.preventDefault());

function draw() {
if (!gameRunning) return;

ctx.clearRect(0, 0, canvas.width, canvas.height);

// ğŸ¨ ç©å®¶ - å›ºå®šé’è‰²ï¼Œä¸è®Šè‰²
ctx.fillStyle = 'cyan';
ctx.fillRect(player.x, player.y, player.width, player.height);

// ğŸ’¥ ç©å®¶å­å½ˆ - å›ºå®šé»ƒè‰²
ctx.fillStyle = 'yellow';
bullets.forEach(b => ctx.fillRect(b.x, b.y, 4, 10));

// ğŸ‘¾ æ•µäºº - å›ºå®šç´…è‰²ï¼Œç„¡è¡€é‡æ¢
ctx.fillStyle = 'red';
enemies.forEach(e => ctx.fillRect(e.x, e.y, e.width, e.height));

// ğŸ”¥ æ•µäººå­å½ˆ - å›ºå®šæ©™è‰²
ctx.fillStyle = 'orange';
enemyBullets.forEach(b => ctx.fillRect(b.x, b.y, 4, 10));
}

function update() {
if (!gameRunning) return;

frame++;
const difficulty = getDifficultySettings();

/* ğŸš€ ç©å®¶ç§»å‹• */
if (keys['a'] && player.x > 0) player.x -= player.speed;
if (keys['d'] && player.x < canvas.width - player.width) player.x += player.speed;
if (keys['w'] && player.y > 0) player.y -= player.speed;
if (keys['s'] && player.y < canvas.height - player.height) player.y += player.speed;

// ğŸ’¥ ç©å®¶å­å½ˆ
const bulletSpeed = 10 + Math.floor((level - 1) / 2);
bullets.forEach((b, i) => {
  b.y -= bulletSpeed;
  if (b.y < 0) bullets.splice(i, 1);
});

enemyBullets.forEach((b, i) => {
  b.y += difficulty.bulletSpeed;
  if (b.y > canvas.height) enemyBullets.splice(i, 1);
});

enemies.forEach((e, i) => {
  e.y += difficulty.enemySpeed;
  if (e.y > canvas.height) enemies.splice(i, 1);
  
  e.shootTimer--;
  if (e.shootTimer <= 0) {
    enemyBullets.push({ x: e.x + e.width / 2 - 2, y: e.y + e.height });
    e.shootTimer = Math.floor(Math.random() * difficulty.enemyShootRate) + 20;
  }
});

// ğŸ‘¾ ç”Ÿæˆæ•µäºº
if (frame % difficulty.spawnRate === 0 && enemies.length < difficulty.maxEnemies) {
  const enemyHealth = difficulty.enemyHealth;
  enemies.push({
    x: Math.random() * (canvas.width - 30),
    y: -40,
    width: 30,
    height: 30,
    health: enemyHealth,
    maxHealth: enemyHealth,
    shootTimer: Math.floor(Math.random() * difficulty.enemyShootRate) + 50
  });
}

// âš¡ ç©å®¶å°„æ“Š
const shootCooldown = Math.max(8 - Math.floor((level - 1) / 3), 3);
if (mouseDown && shootInterval <= 0) {
  bullets.push({ x: player.x + 6, y: player.y });
  bullets.push({ x: player.x + player.width - 10, y: player.y });
  
  if (level >= 5) {
    bullets.push({ x: player.x + player.width / 2 - 2, y: player.y });
  }
  
  shootInterval = shootCooldown;
}
if (shootInterval > 0) shootInterval--;

/* ğŸ’¥ å­å½ˆæ“Šä¸­æ•µæ©Ÿ */
bullets.forEach((b, i) => {
  enemies.forEach((e, j) => {
    if (b.x < e.x + e.width && b.x + 4 > e.x && 
        b.y < e.y + e.height && b.y + 10 > e.y) {
      
      bullets.splice(i, 1);
      e.health -= damage;
      
      if (e.health <= 0) {
        enemies.splice(j, 1);
        score += 10 * e.maxHealth;
        checkLevelUp(); // éœé»˜å‡ç´šï¼Œç„¡æç¤º
        updateUI();
      }
    }
  });
});

/* ğŸ’¥ æ•µæ©Ÿå­å½ˆæ“Šä¸­ç©å®¶ */
enemyBullets.forEach((b, i) => {
  if (b.x < player.x + player.width && b.x + 4 > player.x && 
      b.y < player.y + player.height && b.y + 10 > player.y) {
    gameOver();
    return;
  }
});

/* ğŸ’¥ æ•µæ©Ÿæ’åˆ°ç©å®¶ */
enemies.forEach((e, i) => {
  if (e.x < player.x + player.width && e.x + e.width > player.x && 
      e.y < player.y + player.height && e.y + e.height > player.y) {
    gameOver();
    return;
  }
});
}

/* ğŸ® éŠæˆ²çµæŸå‡½å¼ */
function gameOver() {
gameRunning = false;
document.getElementById("finalScore").textContent = score;
document.getElementById("gameOver").style.display = "block";
}

/* ğŸ“– ç¬¬10ç«  BOM - requestAnimationFrame() */
function gameLoop() {
update();
draw();
if (gameRunning) {
  requestAnimationFrame(gameLoop);
}
}
</script>
</body>
</html>